--- a/libyara/lexer.c
+++ b/libyara/lexer.c
@@ -3252,6 +3252,7 @@ int yr_lex_parse_rules_fd(
   YR_COMPILER* compiler)
 {
   yyscan_t yyscanner;
+  char buf[1024];
 
   compiler->errors = 0;
 
